apply plugin: 'java'

sourceCompatibility = 1.7
version = '1.0'

repositories {
    mavenCentral()
}

dependencies {
    compile files('libs/AVIDemo.jar')
    compile 'org.apache.hadoop:hadoop-mapreduce-client-core:2.6.0'
    compile 'org.apache.hadoop:hadoop-common:2.6.0'
    compile 'org.hsqldb:hsqldb:2.3.2'
    testCompile group: 'junit', name: 'junit', version: '4.11'
}

task copyJarToLib(type: Copy) {
    into "build/tmp/jar/lib"
    from "libs"
}

jar {
    dependsOn copyJarToLib
    from {
        configurations.compile.collect { it.isDirectory() ? it : zipTree(it) }
    }
}

task hadoop(type: Exec) {
    def jar = "build/libs/${rootProject.name}-${version}.jar"
    def myFile = file(jar)
    println myFile.name
    commandLine '/opt/hadoop/bin/hadoop', 'jar', myFile.name
}